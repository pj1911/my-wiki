
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Hyperbolic%20PDEs-1-weak%20solutions/">
      
      
        <link rel="next" href="../RL-1-Introduction/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>3 - Entropy Stable and Hyperbolic Solutions - Prajwal's  Wiki</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/justify.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-to-conservation-law" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Prajwal&#39;s  Wiki" class="md-header__button md-logo" aria-label="Prajwal's  Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Prajwal's  Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              3 - Entropy Stable and Hyperbolic Solutions
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Prajwal&#39;s  Wiki" class="md-nav__button md-logo" aria-label="Prajwal's  Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Prajwal's  Wiki
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Machine Learning
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Machine Learning
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linearRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linear Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Generative%20Adversarial%20Networks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generative Adversarial Networks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Transformers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Transformers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Transformers-1-Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1 – Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Transformers-2-NLP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2 – Natural Language Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Transformers-3-LLMs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3 – Transformer Language Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Transformers-4-MMT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4 – Multimodal Transformers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Mathematics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Mathematics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Fuzzy%20Inference%20Systems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fuzzy Inference Systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Neural network methods for partial differential equations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Neural network methods for partial differential equations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Hamilton-Jacobi%20equations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1 - Hamilton Jacobi Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Hyperbolic%20PDEs-1-weak%20solutions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2 - Weak solutions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    3 - Entropy Stable and Hyperbolic Solutions
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    3 - Entropy Stable and Hyperbolic Solutions
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-conservation-law" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction to conservation law
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction to conservation law">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conservation-law-in-integral-and-differential-form" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conservation law in integral and differential form
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-integral-form-to-differential-form" class="md-nav__link">
    <span class="md-ellipsis">
      
        From integral form to differential form
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-sources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding sources
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finite-volume-method-fvm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Finite Volume Method (FVM)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Finite Volume Method (FVM)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-numerical-problem" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key numerical problem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-stepping-turning-dbarudt-into-updates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time stepping (turning \(d\bar{u}/dt\) into updates)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cfl-condition" class="md-nav__link">
    <span class="md-ellipsis">
      
        CFL condition
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#from-interface-states-to-numerical-fluxes" class="md-nav__link">
    <span class="md-ellipsis">
      
        From interface states to numerical fluxes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="From interface states to numerical fluxes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#godunovs-idea" class="md-nav__link">
    <span class="md-ellipsis">
      
        Godunov's idea
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#higher-order-reconstruction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Higher order reconstruction
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entropy-conservative-and-entropy-stable-fluxes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entropy-conservative and entropy-stable fluxes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Entropy-conservative and entropy-stable fluxes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#entropy-variables-and-flux-potential" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entropy variables and flux potential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entropy-conservative-numerical-flux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entropy-conservative numerical flux
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-dissipation-entropy-stable-fluxes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding dissipation: entropy-stable fluxes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entropy-stable-flux-formulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entropy stable flux formulation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusanov-type-entropy-stable-flux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rusanov-type entropy-stable flux
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guarantee-entropy-stablility-and-hyperbolicity-in-solution-in-d-dimensional-case" class="md-nav__link">
    <span class="md-ellipsis">
      
        Guarantee entropy stablility and hyperbolicity in solution in d-dimensional case
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reinforcement Learning
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reinforcement Learning
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RL-1-Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1 - Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RL-2-Markov%20Decision%20Processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2 - Markov Decision Processes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RL-3-Partially%20Observable%20MDP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3 - Partially Observable MDP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RL-4-Planning%20with%20Dynamic%20Programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4 - Planning with Dynamic Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RL-5-Model%20free%20prediction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5 - Model Free Prediction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RL-6-Model%20free%20control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6 - Model Free Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RL-7-Value%20function%20approximation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7 - Value Function Approximation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-conservation-law" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction to conservation law
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction to conservation law">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conservation-law-in-integral-and-differential-form" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conservation law in integral and differential form
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-integral-form-to-differential-form" class="md-nav__link">
    <span class="md-ellipsis">
      
        From integral form to differential form
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-sources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding sources
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finite-volume-method-fvm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Finite Volume Method (FVM)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Finite Volume Method (FVM)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-numerical-problem" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key numerical problem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-stepping-turning-dbarudt-into-updates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time stepping (turning \(d\bar{u}/dt\) into updates)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cfl-condition" class="md-nav__link">
    <span class="md-ellipsis">
      
        CFL condition
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#from-interface-states-to-numerical-fluxes" class="md-nav__link">
    <span class="md-ellipsis">
      
        From interface states to numerical fluxes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="From interface states to numerical fluxes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#godunovs-idea" class="md-nav__link">
    <span class="md-ellipsis">
      
        Godunov's idea
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#higher-order-reconstruction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Higher order reconstruction
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entropy-conservative-and-entropy-stable-fluxes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entropy-conservative and entropy-stable fluxes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Entropy-conservative and entropy-stable fluxes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#entropy-variables-and-flux-potential" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entropy variables and flux potential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entropy-conservative-numerical-flux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entropy-conservative numerical flux
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-dissipation-entropy-stable-fluxes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding dissipation: entropy-stable fluxes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entropy-stable-flux-formulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entropy stable flux formulation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rusanov-type-entropy-stable-flux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rusanov-type entropy-stable flux
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guarantee-entropy-stablility-and-hyperbolicity-in-solution-in-d-dimensional-case" class="md-nav__link">
    <span class="md-ellipsis">
      
        Guarantee entropy stablility and hyperbolicity in solution in d-dimensional case
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>3 - Entropy Stable and Hyperbolic Solutions</h1>

<h2 id="introduction-to-conservation-law">Introduction to conservation law</h2>
<p>A conservation law is a mathematical statement that something is neither created nor destroyed inside a region, except by flowing across the region's boundary or by external sources. The key idea is change = stuff in - stuff out + sources. Suppose, <span class="arithmatex">\(u(x,t)\)</span> represent the density of that conserved quantity at position <span class="arithmatex">\(x\)</span> and time <span class="arithmatex">\(t\)</span>. Then the conservation principle in 1D says:</p>
<div class="arithmatex">\[
\frac{d}{dt} \Big(\text{amount of $u$ in an interval}\Big) =
\text{(flux entering)} - \text{(flux leaving)} + \text{(sources inside)}.
\]</div>
<p>This flowing in and flowing out of any quantity is defined by the term flux. Flux is the rate at which the conserved quantity crosses a boundary. In 1D, the boundary of an interval <span class="arithmatex">\([a,b]\)</span> is just the two endpoints <span class="arithmatex">\(a\)</span> and <span class="arithmatex">\(b\)</span>. If <span class="arithmatex">\(f(u)\)</span> is the flux function, then:</p>
<ul>
<li><span class="arithmatex">\(f(u(a,t))\)</span> is the rate at which <span class="arithmatex">\(u\)</span> flows from left to right across <span class="arithmatex">\(x=a\)</span>,</li>
<li><span class="arithmatex">\(f(u(b,t))\)</span> is the rate at which <span class="arithmatex">\(u\)</span> flows from left to right across <span class="arithmatex">\(x=b\)</span>.</li>
</ul>
<h3 id="conservation-law-in-integral-and-differential-form">Conservation law in integral and differential form</h3>
<p>The amount of density <span class="arithmatex">\((u)\)</span> in the interval <span class="arithmatex">\([a,b]\)</span> is given by:</p>
<div class="arithmatex">\[
\int_a^b u(x,t)dx.
\]</div>
<p>If the flux in the positive <span class="arithmatex">\(x-\)</span>direction is <span class="arithmatex">\(f(u)\)</span>, assuming no sources for now, gives the conservation law as:</p>
<div class="arithmatex">\[
\frac{d}{dt}\int_a^b u(x,t)dx = f(u(a,t)) - f(u(b,t)) + 0.
\]</div>
<p>This is the conservation law in integral form. It is extremely important because it remains meaningful even when <span class="arithmatex">\(u\)</span> is not smooth (for example, if there is a shock).</p>
<h3 id="from-integral-form-to-differential-form">From integral form to differential form</h3>
<p>Assume <span class="arithmatex">\(u\)</span> is smooth enough that we can move derivatives inside integrals and use the fundamental theorem of calculus. We can rewrite the above as:</p>
<div class="arithmatex">\[
\frac{d}{dt}\int_a^b udx + \big(f(u(b,t)) - f(u(a,t))\big) = 0.
\]</div>
<p>Notice that:</p>
<div class="arithmatex">\[
\frac{d}{dt}\int_a^b u(x,t)dx
= \int_a^b \frac{\partial u}{\partial t}(x,t)dx.
\]</div>
<p>and</p>
<div class="arithmatex">\[
f(u(b,t)) - f(u(a,t)) = \int_a^b \frac{\partial}{\partial x}f(u(x,t))dx.
\]</div>
<p>So:</p>
<div class="arithmatex">\[
\int_a^b \left( \frac{\partial u}{\partial t}(x,t) + \frac{\partial}{\partial x}f(u(x,t))\right)dx = 0.
\]</div>
<p>If this holds for every interval <span class="arithmatex">\([a,b]\)</span>, then in the global sense, the integrand must be zero:</p>
<div class="arithmatex">\[
\frac{\partial u}{\partial t}(x,t) + \frac{\partial}{\partial x}f(u(x,t)) = u_t + \big(f(u)\big)_x = 0.
\]</div>
<p>This is the differential form of a 1D conservation law.</p>
<h3 id="adding-sources">Adding sources</h3>
<p>If there is creation or removal inside the region, represented by a source term <span class="arithmatex">\(s(x,t)\)</span>, then:</p>
<div class="arithmatex">\[
\frac{d}{dt}\int_a^b udx = f(u(a,t)) - f(u(b,t)) + \int_a^b s(x,t)dx,
\]</div>
<p>and the differential form becomes:</p>
<div class="arithmatex">\[
u_t + (f(u))_x = s(x,t).
\]</div>
<h2 id="finite-volume-method-fvm">Finite Volume Method (FVM)</h2>
<p>The finite volume method is built directly from the integral conservation law, so it automatically respects conservation. It works by integrating the PDE over small control volumes (cells) and approximating the fluxes crossing the cell boundaries. Information is exchanged between cells only through these fluxes, so a conservative flux approximation immediately yields a globally conservative scheme.</p>
<p>Step 1: break space into cells:</p>
<p>For any given cell <span class="arithmatex">\(i\)</span>, with center <span class="arithmatex">\(x_i\)</span>. Divide the 1D space into cells:</p>
<div class="arithmatex">\[
[x_{i-\tfrac12}, x_{i+\tfrac12}], \quad \Delta x = x_{i+\tfrac12}-x_{i-\tfrac12}.
\]</div>
<p>Then we can define the cell average (per unit length for 1D case):</p>
<div class="arithmatex">\[
\bar{u}_i(t) = \frac{1}{\Delta x}\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}} u(x,t)dx.
\]</div>
<p>Step 2: integrate the PDE over a cell:</p>
<p>Start from the differential form:</p>
<div class="arithmatex">\[
u_t + (f(u))_x = 0.
\]</div>
<p>Integrate over cell <span class="arithmatex">\(i\)</span>:</p>
<div class="arithmatex">\[
\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}} u_tdx + 
\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}} (f(u))_xdx = 0.
\]</div>
<p>From the first term, we can say for a given cell:</p>
<div class="arithmatex">\[
\int u_tdx = \frac{d}{dt}\int udx = \frac{d}{dt}\big(\Delta x\bar{u}_i(t)\big).
\]</div>
<p>The second term uses the fundamental theorem of calculus:</p>
<div class="arithmatex">\[
\int (f(u))_xdx = f(u(x_{i+\tfrac12},t)) - f(u(x_{i-\tfrac12},t)).
\]</div>
<p>So:</p>
<div class="arithmatex">\[
\frac{d}{dt}\big(\Delta x\bar{u}_i\big) +
 \big(f_{i+\tfrac12} - f_{i-\tfrac12}\big)=0,
\]</div>
<p>where <span class="arithmatex">\(f_{i\pm \tfrac12}\)</span> denotes the flux through the cell face. Dividing by <span class="arithmatex">\(\Delta x\)</span> gives:</p>
<div class="arithmatex">\[
\frac{d\bar{u}_i}{dt} = -\frac{1}{\Delta x}\left(f_{i+\tfrac12}-f_{i-\tfrac12}\right).
\]</div>
<h3 id="key-numerical-problem">Key numerical problem</h3>
<p>The above equation shows that the evolution of <span class="arithmatex">\(\bar{u}_i\)</span> is determined by the boundary or face fluxes <span class="arithmatex">\(f_{i\pm \tfrac12}\)</span>, but these are not directly known from the stored data. We do not know the true face fluxes <span class="arithmatex">\(f_{i\pm \tfrac12}\)</span> because we only store
cell averages. Instead, we introduce a numerical flux at each interface:</p>
<div class="arithmatex">\[
\hat{f}_{i+\tfrac12} = \hat{f}\big(u_{i+\tfrac12}^L,u_{i+\tfrac12}^R\big), 
\qquad
\hat{f}_{i-\tfrac12} = \hat{f}\big(u_{i-\tfrac12}^L,u_{i-\tfrac12}^R\big),
\]</div>
<p>where <span class="arithmatex">\(u_{i\pm\tfrac12}^L\)</span> and <span class="arithmatex">\(u_{i\pm\tfrac12}^R\)</span> are the reconstructed states
immediately to the left and right of the interface <span class="arithmatex">\(x_{i\pm\tfrac12}\)</span>, obtained from
the neighboring cells. For example:</p>
<ul>
<li>at <span class="arithmatex">\(x_{i+\tfrac12}\)</span>, <span class="arithmatex">\(u_{i+\tfrac12}^L\)</span> comes from cell <span class="arithmatex">\(i\)</span> and <span class="arithmatex">\(u_{i+\tfrac12}^R\)</span> from cell <span class="arithmatex">\(i+1\)</span>,</li>
<li>at <span class="arithmatex">\(x_{i-\tfrac12}\)</span>, <span class="arithmatex">\(u_{i-\tfrac12}^L\)</span> comes from cell <span class="arithmatex">\(i-1\)</span> and <span class="arithmatex">\(u_{i-\tfrac12}^R\)</span> from cell <span class="arithmatex">\(i\)</span>.</li>
</ul>
<p>The semi-discrete finite volume update is then</p>
<div class="arithmatex">\[
\frac{d\bar{u}_i}{dt}
  = -\frac{1}{\Delta x}\left(\hat{f}_{i+\tfrac12}-\hat{f}_{i-\tfrac12}\right).
\]</div>
<h3 id="time-stepping-turning-dbarudt-into-updates">Time stepping (turning <span class="arithmatex">\(d\bar{u}/dt\)</span> into updates)</h3>
<p>The semi-discrete scheme given above gives, for each cell, an ODE in time for the averages <span class="arithmatex">\(\bar{u}_i(t)\)</span>,
where the right-hand side depends on the cell averages at the current time but not explicitly on <span class="arithmatex">\(x\)</span>. Thus, the spatial dependence has been replaced by cell indices, leaving a system of ODEs in the single variable <span class="arithmatex">\(t\)</span>. To obtain an implementable method, we now discretize time by choosing a time-stepping scheme for this system. A common simplest method is Forward Euler in time:</p>
<div class="arithmatex">\[
\bar{u}_i^{n+1} = \bar{u}_i^n - \frac{\Delta t}{\Delta x}\left(\hat{f}_{i+\tfrac12}^n-\hat{f}_{i-\tfrac12}^n\right),
\]</div>
<p>where <span class="arithmatex">\(n\)</span> represents the <span class="arithmatex">\(n^{th}\)</span> time step for any cell <span class="arithmatex">\(i\)</span>. Higher accuracy in time uses methods like Runge--Kutta (RK2, RK3), but the flux idea stays the same.</p>
<h3 id="cfl-condition">CFL condition</h3>
<p>Information in hyperbolic conservation laws travels at finite speeds (wave speeds).
Numerically, we do not want a wave to travel farther than one cell in a single
time step: the fastest signal should not skip over cells, so that each update depends only on information from neighboring cells. If <span class="arithmatex">\(|\lambda|\)</span> is a
characteristic wave speed, then in one time step the distance traveled is
approximately <span class="arithmatex">\(|\lambda|\Delta t\)</span>. To keep this below one cell width <span class="arithmatex">\(\Delta x\)</span>, we
require</p>
<div class="arithmatex">\[
|\lambda|\Delta t \;\lesssim\; \Delta x
\quad\Longrightarrow\quad
\Delta t \;\le\; \text{CFL}\cdot \frac{\Delta x}{\max |\lambda|},
\]</div>
<p>where <span class="arithmatex">\(\text{CFL}\in(0,1]\)</span> is a chosen safety factor. For our scalar conservation law <span class="arithmatex">\(u_t + (f(u))_x = 0\)</span>, the characteristic speed is</p>
<div class="arithmatex">\[
\lambda = f'(u),
\]</div>
<p>so we typically use <span class="arithmatex">\(\max |\lambda| = \max |f'(u)|\)</span> over the grid when computing
the time step.</p>
<h2 id="from-interface-states-to-numerical-fluxes">From interface states to numerical fluxes</h2>
<p>At each cell interface the solution is, in general, discontinuous, so the left and
right traces differ:</p>
<div class="arithmatex">\[
u(x_{i+\tfrac12}^-,t) \approx u_L, \qquad
u(x_{i+\tfrac12}^+,t) \approx u_R.
\]</div>
<p>This setup defines a local Riemann problem: the PDE with piecewise constant
initial data having a single jump at <span class="arithmatex">\(x_{i+\tfrac12}\)</span>. A good numerical flux
<span class="arithmatex">\(\hat{f}(u_L,u_R)\)</span> aims to approximate the physical flux at the interface
generated by the solution of this local Riemann problem. As an example, Godunov's method can be used to approximate this flux.</p>
<h3 id="godunovs-idea">Godunov's idea</h3>
<ol>
<li>Approximate the solution in each cell by a constant (piecewise constant reconstruction).</li>
<li>At every interface, pose and solve the corresponding Riemann problem exactly.</li>
<li>Take the interfacial flux from this exact Riemann solution as the numerical flux.</li>
</ol>
<p>This procedure is very faithful to the underlying physics, but exact Riemann solvers
are often costly or complicated. In practice, we therefore use
approximate Riemann solvers, i.e. closed-form numerical flux formulas
that mimic the behavior of the exact solution. For Godunov's original scheme we use a first-order (piecewise constant) reconstruction:</p>
<div class="arithmatex">\[
u_L = \bar{u}_i, \qquad u_R = \bar{u}_{i+1},
\]</div>
<p>so the numerical flux at <span class="arithmatex">\(x_{i+\tfrac12}\)</span> reduces to a function
<span class="arithmatex">\(\hat{f}(\bar{u}_i,\bar{u}_{i+1})\)</span> of neighboring cell averages only. This is very robust,
but the low-order reconstruction makes the method diffusive, smearing sharp
discontinuities and steep gradients.</p>
<h3 id="higher-order-reconstruction">Higher order reconstruction</h3>
<p>To reduce this numerical diffusion, we can move to a higher-order (piecewise linear)
reconstruction. In each cell we reconstruct a slope <span class="arithmatex">\(\sigma_i\)</span> and define</p>
<div class="arithmatex">\[
u_{i+\tfrac12}^L = \bar{u}_i + \frac{1}{2}\sigma_i, \qquad
u_{i+\tfrac12}^R = \bar{u}_{i+1} - \frac{1}{2}\sigma_{i+1},
\]</div>
<p>so that the left and right states at the interface <span class="arithmatex">\(x_{i+\tfrac12}\)</span> come from linear
profiles inside cells <span class="arithmatex">\(i\)</span> and <span class="arithmatex">\(i+1\)</span>. The slopes <span class="arithmatex">\(\sigma_i\)</span> are typically chosen with a
limiter (e.g. minmod, van Leer, MC) to obtain second-order accuracy in smooth
regions. A limiter is a nonlinear function that reduces the slope when neighboring
cell averages are inconsistent (e.g. near a discontinuity), preventing the creation
of new spurious extrema and suppressing Gibbs-type oscillations.</p>
<p>Near true discontinuities the limiter forces the reconstruction to drop back to
(first-order) more diffusive behavior, which is unavoidable if we want to avoid
spurious oscillations. The gain is that away from shocks the scheme remains
second-order accurate, so smooth regions are much less smeared than with a
purely first-order method. In summary, a high-resolution finite volume scheme
consists of a reconstruction procedure plus a suitable numerical flux
<span class="arithmatex">\(\hat{f}(u_L,u_R)\)</span>. There are several popular numerical fluxes for scalar conservation laws. Each
offers a different trade-off between accuracy, robustness, and computational cost. A few example of those are upwind flux, Lax-Friedrichs (Rusanov) flux, Godunov flux, HLL-type flux and many more.</p>
<h2 id="entropy-conservative-and-entropy-stable-fluxes">Entropy-conservative and entropy-stable fluxes</h2>
<p>For many conservation laws it is useful to control, in addition to the
conserved variables <span class="arithmatex">\(u\)</span>, a convex entropy <span class="arithmatex">\(\eta(u)\)</span>.
For the scalar conservation law</p>
<div class="arithmatex">\[
u_t + f(u)_x = 0,
\]</div>
<p>an entropy/entropy-flux pair <span class="arithmatex">\((\eta,q)\)</span> is defined by the relation</p>
<div class="arithmatex">\[
q'(u) = \eta'(u)f'(u).
\]</div>
<p>Assuming <span class="arithmatex">\(u\)</span> is smooth, the chain rule gives</p>
<div class="arithmatex">\[
\eta(u)_t = \eta'(u)u_t,
\qquad
q(u)_x = q'(u)u_x.
\]</div>
<p>From our conservation law we have <span class="arithmatex">\(u_t = -f'(u)u_x\)</span>, hence</p>
<div class="arithmatex">\[
\eta(u)_t
  = \eta'(u)u_t
  = -\eta'(u)f'(u)u_x
  = -q'(u)u_x
  = -q(u)_x.
\]</div>
<p>Therefore we get a conservation law in entropy terms as</p>
<div class="arithmatex">\[
\eta(u)_t + q(u)_x = 0
\]</div>
<p>for smooth solutions, and the inequality
<span class="arithmatex">\(\eta(u)_t + q(u)_x \le 0\)</span> for weak (entropy) solutions. This is discussed in great detail in chapter 2 (weak solutions) of this series.</p>
<p><strong>In d-dimensional system</strong></p>
<p>For a standard <span class="arithmatex">\(d\)</span>-dimensional system of conservation laws, we get</p>
<div class="arithmatex">\[
\frac{\partial u}{\partial t} + \sum_{i=1}^d \frac{\partial}{\partial x_i} f_i(u) = 0,
\]</div>
<p>where</p>
<ul>
<li><span class="arithmatex">\(u(t,x) \in \mathbb{R}^p\)</span> is the vector of conserved variables,</li>
<li>for each spatial direction <span class="arithmatex">\(i = 1,\dots,d\)</span>,
  <span class="arithmatex">\(f_i : D \subset \mathbb{R}^p \to \mathbb{R}^p\)</span> is the flux in the
  <span class="arithmatex">\(x_i\)</span>-direction.</li>
</ul>
<p>In entropy terms the original system can be written as a scalar
conservation law for <span class="arithmatex">\(\eta\)</span>, i.e.</p>
<div class="arithmatex">\[
\frac{\partial}{\partial t}\eta(u) + \sum_{i=1}^d \frac{\partial}{\partial x_i} g_i(u) = 0,
\]</div>
<p>The equation above expresses exactly the condition that
<span class="arithmatex">\(\eta,\{g_i\}\)</span> form an entropy / entropy–flux pair compatible
with the fluxes <span class="arithmatex">\(\{f_i\}\)</span>.</p>
<h3 id="entropy-variables-and-flux-potential">Entropy variables and flux potential</h3>
<p>We have our conservation law for smooth solutions in entropy terms as</p>
<div class="arithmatex">\[
\eta(u)_t + q(u)_x = 0
\]</div>
<p>Then, we can define the entropy variables <span class="arithmatex">\(v := \eta'(u)\)</span>. Using the chain rule, the above equation can be written as</p>
<div class="arithmatex">\[
v^\top u_t + q'(u) u_x = 0.
\]</div>
<p>From our conservation law <span class="arithmatex">\(u_t = -f(u)_x = -f'(u)u_x\)</span> we obtain</p>
<div class="arithmatex">\[
-v^\top f'(u)u_x + q'(u)u_x = 0
\quad\Rightarrow\quad
\bigl(q'(u) - v^\top f'(u)\bigr)u_x = 0.
\]</div>
<p>Since this must hold for arbitrary smooth <span class="arithmatex">\(u(x,t)\)</span>, we require the
compatibility condition</p>
<div class="arithmatex">\[
q'(u) = v^\top f'(u)
\quad\text{or}\quad
\nabla_u q(u) = \eta'(u)^\top f'(u).
\]</div>
<p>Using the chain rule and the compatibility relation
from above, we have</p>
<div class="arithmatex">\[
q(u)_x = q'(u)u_x = v^\top f'(u)u_x = v^\top f(u)_x.
\]</div>
<p>Thus the entropy law can already be written as</p>
<div class="arithmatex">\[
\eta(u)_t + v^\top f(u)_x = 0.
\]</div>
<p><strong>In d-dimensional system</strong></p>
<p>Since, the entropy function <span class="arithmatex">\(\eta\)</span> is strictly convex, the map</p>
<div class="arithmatex">\[
u \;\longmapsto\; v(u) := \bigl(\nabla_{u}\eta(u)\bigr)^\top
\]</div>
<p>is one–to–one on the domain of interest.  Therefore there exists an inverse map</p>
<div class="arithmatex">\[
\Psi : \mathbb{R}^p \to \mathbb{R}^p, \qquad \Psi(v) = u \quad\text{such that}\quad v = \bigl(\nabla_{u}\eta(u)\bigr)^\top.
\]</div>
<p>We can now re-express each physical flux <span class="arithmatex">\(f_i\)</span> as a function of the entropy
variables <span class="arithmatex">\(v\)</span>, by composition with the above function:</p>
<div class="arithmatex">\[
g_i(v) := f_i\!\bigl(\Psi(v)\bigr), \qquad i = 1,\dots,d.
\]</div>
<p>We can now rewrite the conservation law in terms of entropy variables using the chain rule. As <span class="arithmatex">\(u\)</span> depends on <span class="arithmatex">\(v\)</span>, we have</p>
<div class="arithmatex">\[
\frac{\partial u}{\partial t} = \frac{\partial u}{\partial v} \frac{\partial v}{\partial t} = \nabla_{v}u(v)  \frac{\partial v}{\partial t}.
\]</div>
<p>Similarly, for each spatial coordinate <span class="arithmatex">\(x_i\)</span>,</p>
<div class="arithmatex">\[
\frac{\partial}{\partial x_i}f_i(u) = \frac{\partial}{\partial x_i}g_i(v) = \nabla_{v}g_i(v)  \frac{\partial v}{\partial x_i}.
\]</div>
<p>Substitute these expressions into the conservation law:</p>
<div class="arithmatex">\[
\begin{aligned}
0 &amp;= \frac{\partial u}{\partial t} + \sum_{i=1}^d \frac{\partial}{\partial x_i}f_i(u) \\
0 &amp;= \nabla_{v}u(v)  \frac{\partial v}{\partial t} + \sum_{i=1}^d \nabla_{v}g_i(v)  \frac{\partial v}{\partial x_i}.
\end{aligned}
\]</div>
<p>Rearranging, we obtain the symmetrized form</p>
<div class="arithmatex">\[
\nabla_{v}u(v)\frac{\partial v}{\partial t} + \sum_{i=1}^d \nabla_{v}g_i(v)\frac{\partial v}{\partial x_i} = 0.
\]</div>
<p>Using the inverse map <span class="arithmatex">\(\Psi\)</span> introduced above, we can write</p>
<div class="arithmatex">\[
u = \Psi(v),
\]</div>
<div class="arithmatex">\[
\nabla_{v}\Psi(v)\frac{\partial v}{\partial t} + \sum_{i=1}^d \nabla_{v}g_i(v)\frac{\partial v}{\partial x_i} = 0,
\]</div>
<p>where</p>
<div class="arithmatex">\[
\nabla_{v}g_i(v) = \nabla_{v}\bigl(f_i(\Psi(v))\bigr) = \nabla_{u}f_i\bigl(\Psi(v)\bigr)\nabla_{v}\Psi(v).
\]</div>
<p>The above equation is the symmetric form of the original
conservation law, written entirely in terms of the entropy variables
<span class="arithmatex">\(v\)</span> and the inverse map <span class="arithmatex">\(\Psi\)</span>.</p>
<p><strong>Interface notation.</strong></p>
<p>At each cell interface <span class="arithmatex">\(x_{i+\frac12}\)</span> we have a left state and a
right state.  For example,
<span class="arithmatex">\(u_{i+\frac12}^-\)</span> and <span class="arithmatex">\(u_{i+\frac12}^+\)</span> are the left and right limits
of <span class="arithmatex">\(u(x)\)</span> at <span class="arithmatex">\(x_{i+\frac12}\)</span>, and the corresponding entropy variables
are <span class="arithmatex">\(v_{i+\frac12}^\pm := \eta'(u_{i+\frac12}^\pm)\)</span>.</p>
<h3 id="entropy-conservative-numerical-flux">Entropy-conservative numerical flux</h3>
<p>In a finite-volume method, the only information available at the interface
<span class="arithmatex">\(x_{i+\frac12}\)</span> is the left and right cell states
<span class="arithmatex">\(u_{i+\frac12}^-\)</span> and <span class="arithmatex">\(u_{i+\frac12}^+\)</span>.<br />
Therefore, we use a two-point numerical flux, which is simply a function that uses only these two states to approximate the physical flux at the interface:</p>
<div class="arithmatex">\[
f^{\mathrm{ec}}_{i+\frac12}
  = f^{\mathrm{ec}}(u_{i+\frac12}^-,u_{i+\frac12}^+),
\]</div>
<p>with the consistency requirement
<span class="arithmatex">\(f^{\mathrm{ec}}(u,u) = f(u)\)</span> where <span class="arithmatex">\(ec\)</span> denotes  entropy-conservative.</p>
<p>We now ask for this flux to be compatible with the entropy structure. Consider the semi-discrete finite-volume scheme built from
<span class="arithmatex">\(f^{\mathrm{ec}}_{i+\frac12}\)</span>,</p>
<div class="arithmatex">\[
\frac{d}{dt}\bar{u}_i(t)
  = -\frac{1}{\Delta x}
    \bigl(f^{\mathrm{ec}}_{i+\frac12} - f^{\mathrm{ec}}_{i-\frac12}\bigr).
\]</div>
<p>Using the chain rule cell by cell, we first differentiate the entropy
in each cell:</p>
<div class="arithmatex">\[
\frac{d}{dt}\eta(\bar u_i(t))
  = \eta'(\bar u_i(t))^\top \frac{d}{dt}\bar u_i(t)
  = v_i^\top \frac{d}{dt}\bar u_i(t),
\]</div>
<p>since by definition <span class="arithmatex">\(v_i := \eta'(\bar u_i)\)</span>. Now multiply by the cell width <span class="arithmatex">\(\Delta x\)</span> and sum over all cells (substituting value from the semi discrete finite volume scheme):</p>
<div class="arithmatex">\[
\sum_i v_i^\top \frac{d}{dt}\bar u_i(t)\Delta x = -\sum_i v_i^\top
       \bigl(f^{\mathrm{ec}}_{i+\frac12}-f^{\mathrm{ec}}_{i-\frac12}\bigr).
\]</div>
<p>A discrete integration-by-parts is just an index shift that makes the
interface contributions telescope in the same way as in the continuous
case. For this we start from</p>
<div class="arithmatex">\[
-\sum_i v_i^\top
   \bigl(f^{\mathrm{ec}}_{i+\frac12}-f^{\mathrm{ec}}_{i-\frac12}\bigr)
  = -\sum_i v_i^\top f^{\mathrm{ec}}_{i+\frac12}
    + \sum_i v_i^\top f^{\mathrm{ec}}_{i-\frac12}.
\]</div>
<p>In the second sum, perform the index shift <span class="arithmatex">\(j = i-1\)</span>:</p>
<div class="arithmatex">\[
\sum_i v_i^\top f^{\mathrm{ec}}_{i-\frac12}
  = \sum_j v_{j+1}^\top f^{\mathrm{ec}}_{j+\frac12},
\]</div>
<p>so, renaming <span class="arithmatex">\(j\)</span> back to <span class="arithmatex">\(i\)</span>,</p>
<div class="arithmatex">\[
-\sum_i v_i^\top
   \bigl(f^{\mathrm{ec}}_{i+\frac12}-f^{\mathrm{ec}}_{i-\frac12}\bigr)
  = -\sum_i v_i^\top f^{\mathrm{ec}}_{i+\frac12}
    + \sum_i v_{i+1}^\top f^{\mathrm{ec}}_{i+\frac12}.
\]</div>
<p>Now combine the two sums:</p>
<div class="arithmatex">\[
-\sum_i v_i^\top
   \bigl(f^{\mathrm{ec}}_{i+\frac12}-f^{\mathrm{ec}}_{i-\frac12}\bigr)
  = \sum_i (v_{i+1} - v_i)^\top f^{\mathrm{ec}}_{i+\frac12}.
\]</div>
<p>If we interpret the left cell of interface <span class="arithmatex">\(x_{i+\frac12}\)</span> as
<span class="arithmatex">\(v_{i+\frac12}^- := v_i\)</span> and the right cell as
<span class="arithmatex">\(v_{i+\frac12}^+ := v_{i+1}\)</span>, then</p>
<div class="arithmatex">\[
[v]_{i+\frac12}
  := v_{i+\frac12}^+ - v_{i+\frac12}^-
   = v_{i+1} - v_i,
\]</div>
<p>and we can write</p>
<div class="arithmatex">\[
-\sum_i v_i^\top
   \bigl(f^{\mathrm{ec}}_{i+\frac12}-f^{\mathrm{ec}}_{i-\frac12}\bigr) =
   \sum_i [v]_{i+\frac12}^\top f^{\mathrm{ec}}_{i+\frac12}.
\]</div>
<p>This is the discrete analogue of an integration-by-parts formula. To make this look like a discrete conservation law for the entropy case, we
require that each interface contribution can be written as a jump
of a scalar potential <span class="arithmatex">\(\psi\)</span>, i.e.</p>
<div class="arithmatex">\[
[v]_{i+\frac12}^\top f^{\mathrm{ec}}_{i+\frac12} =
   [\psi]_{i+\frac12} :=
   \psi\bigl(v_{i+\frac12}^+\bigr) -
      \psi\bigl(v_{i+\frac12}^-\bigr)
\]</div>
<p>for all left/right states.  This is the discrete entropy identity. With this condition, the total discrete entropy satisfies</p>
<div class="arithmatex">\[
\frac{d}{dt}\sum_i \eta(\bar u_i)\Delta x =
\sum_i [\psi]_{i+\frac12},
\]</div>
<p>which telescopes and vanishes under periodic (or suitable) boundary
conditions. This is because each term <span class="arithmatex">\([\psi]_{i+\frac12} = \psi_{i+\frac12}^+ - \psi_{i+\frac12}^-\)</span> is a
difference of neighboring interface values, so</p>
<div class="arithmatex">\[
\sum_i [\psi]_{i+\frac12}=
\sum_i \bigl(\psi_{i+\frac12}^+ - \psi_{i+\frac12}^-\bigr)
\]</div>
<p>forms a telescoping sum: all interior contributions cancel pairwise, leaving
only boundary terms.  For periodic boundaries (or if the entropy flux is
zero at the physical boundaries), these remaining boundary terms also cancel
(or vanish), so the total sum is zero and the discrete entropy is conserved.</p>
<div class="arithmatex">\[
\frac{d}{dt}\sum_i \eta(\bar u_i)\Delta x = 0.
\]</div>
<h3 id="adding-dissipation-entropy-stable-fluxes">Adding dissipation: entropy-stable fluxes</h3>
<p>Exact entropy conservation is too weak in the presence of shocks: the
physically relevant (entropy) solution satisfies
<span class="arithmatex">\(\eta(u)_t + q(u)_x \le 0\)</span>, i.e. entropy should decrease, not be
preserved.  Our entropy-conservative flux <span class="arithmatex">\(f^{\mathrm{ec}}_{i+\frac12}\)</span>
gives</p>
<div class="arithmatex">\[
\frac{d}{dt}\sum_i \eta(\bar u_i)\Delta x = 0,
\]</div>
<p>so we now modify the interface fluxes in such a way that the total
entropy becomes nonincreasing.</p>
<p>The idea is to add a dissipative term at each interface that is
negative definite in terms of the entropy variables.  Since
<span class="arithmatex">\(v = \eta'(u)\)</span> are the natural variables for the entropy, we take a
correction that is linear in the jump <span class="arithmatex">\([v]_{i+\frac12}\)</span> and symmetric
between the two neighboring cells.  This leads to the ansatz</p>
<div class="arithmatex">\[
\hat f_{i+\frac12}
  := f^{\mathrm{ec}}_{i+\frac12}
     - \tfrac12 D_{i+\frac12}[v]_{i+\frac12},
\]</div>
<p>where <span class="arithmatex">\(D_{i+\frac12}\)</span> is a symmetric positive semidefinite matrix
(<span class="arithmatex">\(D_{i+\frac12} \ge 0\)</span> in the scalar case).</p>
<p>The form <span class="arithmatex">\(f^{\mathrm{ec}} - \tfrac12 D[v]\)</span> is chosen for two reasons:</p>
<ul>
<li>The correction is centered at the interface and depends only on
  the jump <span class="arithmatex">\([v]_{i+\frac12} = v_{i+\frac12}^+ - v_{i+\frac12}^-\)</span>,
  so it vanishes for smooth (locally constant) states and does not
  destroy conservation of <span class="arithmatex">\(u\)</span>.</li>
<li>When we repeat the entropy calculation with <span class="arithmatex">\(\hat f_{i+\frac12}\)</span>,
  the extra term contributes</li>
</ul>
<div class="arithmatex">\[
-\frac12\sum_i [v]_{i+\frac12}^\top
                D_{i+\frac12}[v]_{i+\frac12} \le 0
\]</div>
<p>to <span class="arithmatex">\(\dfrac{d}{dt}\sum_i \eta(\bar u_i)\Delta x\)</span>, because
  <span class="arithmatex">\(D_{i+\frac12}\)</span> is positive semidefinite.  Thus the total
  discrete entropy becomes nonincreasing, which is exactly the
  discrete analogue of the continuous entropy inequality.</p>
<p>In this sense, an entropy-stable flux is obtained by starting from an
entropy-conservative flux and adding a carefully designed, symmetric
dissipation term written in entropy variables.</p>
<p>Using <span class="arithmatex">\(\hat f_{i+\frac12}\)</span> in our semi-discrete finite volume method, yields the
semi-discrete scheme</p>
<div class="arithmatex">\[
\frac{d}{dt}\bar{u}_i(t) =
   -\frac{1}{\Delta x}
    \bigl(\hat f_{i+\frac12} - \hat f_{i-\frac12}\bigr).
\]</div>
<p>Repeating the above summation argument,</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{d}{dt}\sum_i \eta(\bar u_i)\Delta x
  &amp;= \sum_i [v]_{i+\frac12}^\top \hat f_{i+\frac12} \\
  &amp;= \sum_i [v]_{i+\frac12}^\top f^{\mathrm{ec}}_{i+\frac12}
     - \frac12\sum_i [v]_{i+\frac12}^\top
                      D_{i+\frac12}[v]_{i+\frac12}.
\end{aligned}
\]</div>
<p>The first term is the same as before and equals
<span class="arithmatex">\(\sum_i [\psi]_{i+\frac12}\)</span>, which vanishes under periodic (or suitable)
boundary conditions.  Thus</p>
<div class="arithmatex">\[
\frac{d}{dt}\sum_i \eta(\bar u_i)\Delta x = -
   \frac12\sum_i [v]_{i+\frac12}^\top
                    D_{i+\frac12}[v]_{i+\frac12}
  \;\le\; 0,
\]</div>
<p>because each quadratic form
<span class="arithmatex">\([v]_{i+\frac12}^\top D_{i+\frac12}[v]_{i+\frac12}\)</span> is nonnegative.
Hence the total discrete entropy is nonincreasing in time, and the scheme
is called entropy-stable.</p>
<h3 id="entropy-stable-flux-formulation">Entropy stable flux formulation</h3>
<p>In the previous subsection, we obtained an entropy-stable numerical
flux by starting from an entropy-conservative flux
<span class="arithmatex">\(f^{\mathrm{ec}}_{i+\frac12}\)</span> and adding a symmetric dissipation term
<span class="arithmatex">\(-\tfrac12 D_{i+\frac12}[v]_{i+\frac12}\)</span>, which guarantees a discrete
entropy inequality.  It remains to specify how to construct
<span class="arithmatex">\(f^{\mathrm{ec}}_{i+\frac12}\)</span> itself. Now, we derive a
practical entropy-conservative flux by enforcing the discrete entropy
condition
<span class="arithmatex">\(
[v]_{i+\frac12}^\top f^{\mathrm{ec}}_{i+\frac12} = [\phi(v)]_{i+\frac12}
\)</span>
at each interface with
<span class="arithmatex">\([v]_{i+\frac12} := v_{i+\frac12}^+ - v_{i+\frac12}^-\)</span> and
<span class="arithmatex">\([\phi(v)]_{i+\frac12} := \phi(v_{i+\frac12}^+) - \phi(v_{i+\frac12}^-)\)</span>.</p>
<p>We start from a centered flux and add a correction by taking the arithmetic average of the physical fluxes</p>
<div class="arithmatex">\[
f^{\mathrm{c}}_{i+\frac12} :=
 \tfrac12\Big(f(u_{i+\frac12}^+)+f(u_{i+\frac12}^-)\Big),
\]</div>
<p>and look for <span class="arithmatex">\(f^{\mathrm{ec}}_{i+\frac12}\)</span> of the form</p>
<div class="arithmatex">\[
f^{\mathrm{ec}}_{i+\frac12} =
  f^{\mathrm{c}}_{i+\frac12} +
    \alpha_{i+\frac12}[v]_{i+\frac12},
\]</div>
<p>where <span class="arithmatex">\(\alpha_{i+\frac12}\)</span> is a scalar to be determined.<br />
Only the component of the correction parallel to <span class="arithmatex">\([v]_{i+\frac12}\)</span>
can change the scalar product
<span class="arithmatex">\([v]_{i+\frac12}^\top f^{\mathrm{ec}}_{i+\frac12}\)</span>, so this is the
minimal modification needed to enforce the entropy condition.</p>
<p>Now we impose the discrete entropy condition and plug the ansatz into <span class="arithmatex">\([v]_{i+\frac12}^\top f^{\mathrm{ec}}_{i+\frac12} = [\phi(v)]_{i+\frac12}\)</span>:</p>
<div class="arithmatex">\[
[v]_{i+\frac12}^\top f^{\mathrm{c}}_{i+\frac12} +
 \alpha_{i+\frac12}\|[v]_{i+\frac12}\|_2^2 =
 [\phi(v)]_{i+\frac12}.
\]</div>
<p>Hence</p>
<div class="arithmatex">\[
\alpha_{i+\frac12}= \frac{[\phi(v)]_{i+\frac12} -
         [v]_{i+\frac12}^\top f^{\mathrm{c}}_{i+\frac12}}
        {\|[v]_{i+\frac12}\|_2^2}.
\]</div>
<p>Insert <span class="arithmatex">\(\alpha_{i+\frac12}\)</span> back into the flux. Using the expression for <span class="arithmatex">\(f^{\mathrm{c}}_{i+\frac12}\)</span>, we obtain</p>
<div class="arithmatex">\[
f^{\mathrm{ec}}_{i+\frac12} =
  \tfrac12\Big(f(u_{i+\frac12}^+)
               +f(u_{i+\frac12}^-)\Big) +
  \frac{
    [\phi(v)]_{i+\frac12} -
     \tfrac12 [v]_{i+\frac12}^\top
      \Big(f(u_{i+\frac12}^+)+f(u_{i+\frac12}^-)\Big)}
    {\|[v]_{i+\frac12}\|_2^2}
   [v]_{i+\frac12},
\]</div>
<p>At this point we have an explicit interface flux
<span class="arithmatex">\(f^{\mathrm{ec}}_{i+\frac12}\)</span> that is entropy-conservative by
construction, i.e. it satisfies
<span class="arithmatex">\([v]_{i+\frac12}^\top f^{\mathrm{ec}}_{i+\frac12}=[\phi(v)]_{i+\frac12}\)</span>.
This is precisely the baseline flux needed in the discrete entropy condition, adding
the symmetric dissipation term then yields an entropy-stable flux.</p>
<h3 id="rusanov-type-entropy-stable-flux">Rusanov-type entropy-stable flux</h3>
<p>Consider a hyperbolic system</p>
<div class="arithmatex">\[
u_t + f(u)_x = 0.
\]</div>
<p>The classical Rusanov (local Lax--Friedrichs) numerical flux can be written as a central flux plus a scalar dissipation proportional to the state jump,</p>
<div class="arithmatex">\[
f^{\mathrm{Rus}}(u^-,u^+) = \frac{f(u^-)+f(u^+)}{2} - \frac{1}{2}\,\lambda^{\max}\,(u^+-u^-),
\]</div>
<p>where <span class="arithmatex">\(\lambda^{\max}\)</span> is a local estimate of the largest characteristic speed (typically the spectral radius of the flux Jacobian).</p>
<p>To obtain entropy stability, we mimic this structure but add dissipation in the direction of the entropy--variable jump. This yields a Rusanov--type (local Lax--Friedrichs) entropy--stable flux</p>
<div class="arithmatex">\[
\tilde f_{i+1/2}^{\theta,\mu} = f_{i+1/2}^{\theta,\mu,ec} - \frac{1}{2}\,\lambda^{\max}_{i+1/2}
  \Big( H_u \eta_\theta(\bar u_{i+1/2}) \Big)^{-1}
  \Big(
    \nabla_u \eta_\theta(u_{i+1/2}^+) -
     \nabla_u \eta_\theta(u_{i+1/2}^-)
  \Big).
\]</div>
<p>Here <span class="arithmatex">\(\bar u_{i+1/2}\)</span> denotes a suitable average state (e.g., the arithmetic mean of <span class="arithmatex">\(u_{i+1/2}^-\)</span> and <span class="arithmatex">\(u_{i+1/2}^+\)</span>). Defining the diffusion matrix</p>
<div class="arithmatex">\[
D_{i+1/2} :=
 \lambda^{\max}_{i+1/2}
   \Big( H_u \eta_\theta(\bar u_{i+1/2}) \Big)^{-1},
\]</div>
<p>the added term is of local Lax-Friedrichs type: a scalar maximum wave speed <span class="arithmatex">\(\lambda^{\max}_{i+1/2}\)</span> multiplied by a (symmetric) positive semidefinite diffusion operator acting on the entropy-variable jump. Indeed, <span class="arithmatex">\(H_u\eta_\theta(\bar u_{i+1/2})\)</span> is symmetric positive definite, and <span class="arithmatex">\(\lambda^{\max}_{i+1/2}\ge 0\)</span>, hence <span class="arithmatex">\(D_{i+1/2}\)</span> is symmetric positive semidefinite.</p>
<p>The local maximum wave speed is chosen as the spectral radius</p>
<div class="arithmatex">\[
\lambda^{\max}_{i+1/2} = \rho\!\big( B^{1/2} A B^{1/2} \big), \qquad
A = H_v \varphi_\mu(\bar v_{i+1/2}),\quad
B = H_u \eta_\theta(\bar u_{i+1/2}),
\]</div>
<p>where <span class="arithmatex">\(\rho(M)\)</span> denotes the spectral radius of a square matrix <span class="arithmatex">\(M\)</span>,</p>
<div class="arithmatex">\[
\rho(M) := \max\{\,|\lambda| : \lambda \in \sigma(M)\,\},
\]</div>
<p>with <span class="arithmatex">\(\sigma(M)\)</span> the set of eigenvalues of <span class="arithmatex">\(M\)</span>, <span class="arithmatex">\(\bar v_{i+1/2} = \nabla_u\eta_\theta(\bar u_{i+1/2})^\top\)</span>.
Since <span class="arithmatex">\(B^{1/2} A B^{1/2}\)</span> is symmetric, its eigenvalues are real, and
<span class="arithmatex">\(\lambda^{\max}_{i+1/2}\)</span> provides a local approximation of the largest characteristic speed of the learned hyperbolic system. Consequently, <span class="arithmatex">\(\tilde f_{i+1/2}^{\theta,\mu}\)</span> reduces to the entropy--conservative flux in smooth regions (when jumps are small) and adds the minimal upwind diffusion aligned with</p>
<div class="arithmatex">\[
[[\nabla_u\eta_\theta(u)]]_{i+1/2}
\]</div>
<p>needed to enforce the discrete entropy inequality.</p>
<h2 id="guarantee-entropy-stablility-and-hyperbolicity-in-solution-in-d-dimensional-case">Guarantee entropy stablility and hyperbolicity in solution in d-dimensional case</h2>
<p>To guarantee entropy stable solution and hyperbolicity, the requirement that the flux Jacobian has real eigenvalues and
a complete set of eigenvectors, is a property essential for well-posedness and wavepropagation dynamics. We can restrict the entropy to be convex by certain parameterization (for example parameterizing it as a input convex neural network)</p>
<div class="arithmatex">\[
\eta_\theta : \mathbb{R}^p \to \mathbb{R},
\]</div>
<p>with parameters <span class="arithmatex">\(\theta\)</span> so by construction <span class="arithmatex">\(\eta_\theta\)</span> is convex in <span class="arithmatex">\(u\)</span>. Then the corresponding entropy variables</p>
<div class="arithmatex">\[
v(u) := \bigl(\nabla_{u}\eta_\theta(u)\bigr)^\top.
\]</div>
<p>has its Hessian
<span class="arithmatex">\(H_{u}\eta_\theta(u)\)</span> as symmetric positive definite, so this map is
again invertible (at least locally). Now we introduce a scalar potential function</p>
<div class="arithmatex">\[
\phi_{\mu,i} : \mathbb{R}^p \to \mathbb{R},
\]</div>
<p>with parameters <span class="arithmatex">\(\mu\)</span>, and define the flux in entropy variables as the gradient of this potential:</p>
<div class="arithmatex">\[
g_i(v) := \nabla_{v}\phi_{\mu,i}(v), \qquad i=1,\dots,d.
\]</div>
<p>Now we demand this to be symmetric in entropy variables
<span class="arithmatex">\(v\)</span>, for this we would like the Jacobians</p>
<div class="arithmatex">\[
\nabla_{v}g_i(v)
\]</div>
<p>to be symmetric matrices.  A very simple way to guarantee this is to
represent each <span class="arithmatex">\(g_i\)</span> as the gradient of the scalar potential
<span class="arithmatex">\(\phi_{\mu,i}\)</span>, because then</p>
<div class="arithmatex">\[
\nabla_{v}g_i(v) = \nabla_{v}\bigl(\nabla_{v}\phi_{\mu,i}(v)\bigr) = H_{v}\phi_{\mu,i}(v),
\]</div>
<p>which is automatically symmetric. So we are free to choose any parametric form for the flux
<span class="arithmatex">\(g_i\)</span>; choosing it as a gradient <span class="arithmatex">\(\nabla_{v}\phi_{\mu,i}\)</span> is
a deliberate design choice that builds the desired symmetry (and hence
hyperbolic structure) into the model.</p>
<p>We now want a flux written directly in terms of the conserved variables
<span class="arithmatex">\(u\)</span>.  Conceptually, we demand that the flux in entropy variables
<span class="arithmatex">\(g_i\)</span> and the flux in conserved variables <span class="arithmatex">\(f_i^{\theta,\mu}\)</span> are
related by</p>
<div class="arithmatex">\[
g_i(v) = f_i^{\theta,\mu}\bigl(\Psi_\theta(v_{\theta}(u))\bigr), \qquad i = 1,\dots,d.
\]</div>
<p>Equivalently, if we start from a given <span class="arithmatex">\(u\)</span>, we compute
<span class="arithmatex">\(v_\theta(u) = (\nabla_{u}\eta_\theta(u))^\top\)</span> and plug
this into <span class="arithmatex">\(g_i\)</span>.  This defines the parametric flux in conserved variables:</p>
<div class="arithmatex">\[
f_i^{\theta,\mu}(u) := g_i\bigl(v_\theta(u)\bigr) = \left.\nabla_{v}\phi_{\mu,i}(v)\right|_{v = (\nabla_{u}\eta_\theta(u))^\top}.
\]</div>
<p>Remember, that this is only a definition: we have chosen a particular parametric form for
the flux and the flux-potential function.
Finally, we return to the original conservative form
and replace the unknown fluxes <span class="arithmatex">\(f_i\)</span> by the
parametric fluxes <span class="arithmatex">\(f_i^{\theta,\mu}\)</span>. This gives</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{\partial u}{\partial t} + \sum_{i=1}^d \frac{\partial}{\partial x_i} f_i^{\theta,\mu}(u) &amp;= 0,
\end{aligned}
\]</div>
<div class="arithmatex">\[
\boxed{
\frac{\partial u}{\partial t} +
 \sum_{i=1}^d
  \frac{\partial}{\partial x_i}
  \underbrace{
    \nabla_{v}\phi_{\mu,i}\!\bigl(\nabla_{u}\eta_\theta(u)\bigr)
  }_{\displaystyle f_i^{\theta,\mu}(u)}
= 0.
}
\]</div>
<p><strong>Hyperbolicity by construction.</strong></p>
<p>The flux Jacobian in direction <span class="arithmatex">\(i\)</span> is</p>
<div class="arithmatex">\[
\nabla_u f_i^{\theta,\mu}(u) = H_v \phi_{\mu,i}(v)\, H_u \eta_\theta(u) =: A_i B,
\]</div>
<p>where <span class="arithmatex">\(A_i\)</span> is symmetric and <span class="arithmatex">\(B\)</span> is symmetric positive definite.
The product <span class="arithmatex">\(A_i B\)</span> is similar to the symmetric matrix
<span class="arithmatex">\(B^{1/2} A_i B^{1/2}\)</span>, hence has real eigenvalues and a complete set
of eigenvectors. Therefore the system is hyperbolic, with
<span class="arithmatex">\(\eta_\theta\)</span> serving as a strictly convex entropy.</p>
<h2 id="references">References</h2>
<ul>
<li>Liu, L., Zhang, L., &amp; Gelb, A. (2026). Parametric Hyperbolic Conservation Laws: A Unified Framework for Conservation, Entropy Stability, and Hyperbolicity. arXiv preprint arXiv:2601.21080.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../js/mathjax-config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>